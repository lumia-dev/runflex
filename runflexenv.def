Bootstrap: docker
From: ubuntu:22.04

%post

    apt-get -y update
    apt-get -y upgrade

    apt install -y python3.10 git vim htop rsync rclone gfortran makedepf90 wget make python-is-python3 python3-pip
	apt install -y libeccodes0 libeccodes-dev
	apt install -y libnetcdff-dev

	apt-get -y clean
	apt-get -y autoremove

    mkdir /meteo
    mkdir /output
    mkdir /scratch

    # Pre-install python package:
    export PYPTH=/usr/local/lib/python3.10/dist-packages
    echo /runflex >> ${PYPTH}/easy-install.pth
    echo /runflex >> ${PYPTH}/runflex.egg-link

%files
    . /runflex

%runscript
    if [ $# -ne 0 ]
    then
        runflex $@
    else
        bash
    fi
